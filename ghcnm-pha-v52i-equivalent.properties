# ====================================================================
# GHCNM PHA v52i-Equivalent Configuration
#
# This configuration reproduces v52i (GHCNM v3) algorithm behavior
# using the reconstructed GHCNM v4 codebase.
#
# Based on analysis of stable-v52i branch source code.
# See V52I_TO_V4_COMPARISON.md for detailed mapping explanation.
# ====================================================================

# === General Run Parameters ===
# Note: version is truncated to 4 chars in output filenames
pha.version = v52i
pha.begin-year = 1880
pha.element = tmax
pha.input-data-type = raw
pha.neighbors.input-data-type = raw

# === File Path Configuration ===
pha.path.station-metadata = data/ghcnm.inv
pha.path.neighbors.distance = output/neighbors/neighbors-distance.txt
pha.path.neighbors.correlation = output/neighbors/neighbors-correlation.txt
pha.path.neighbors.correlation-in = output/neighbors/neighbors-correlation.txt
pha.path.station-element-data-in = data/ghcnm_v4/{pha.input-data-type}/
pha.path.neighbors.station-element-data-in = data/ghcnm_v4/{pha.neighbors.input-data-type}/
pha.path.station-element-data-out = output/ghcnm_v4_adjusted/{pha.element}/
pha.path.station-history = data/history/

# === Neighbor Selection Parameters (v52i standard) ===
# v52i: NEIGH_CLOSE = 40
pha.neighbors.distance-neighbor-limit = 40

# v52i: NEIGH_FINAL = 20
pha.neighbors.final-neighbor-limit = 20

# v52i: NEIGH_CORR = 1diff
pha.neighbors.method = first-diffs

# v52i: MIN_STNS = 7
pha.neighbors.min-station-coverage = 7

# Minimum correlation (not explicit in v52i, typically 0.1)
pha.neighbors.min-coefficient = 0.1

# === Changepoint Detection Parameters (v52i standard) ===
# v52i: SNHT_THRES = 5 (95% significance)
pha.snht-threshold = 5

# v52i: BIC_PENALTY = bic
pha.bic-penalty = bic

# v52i: AMPLOC_PCT = 92 (92.5% confidence)
pha.amploc-percent = 92

# v52i: CONFIRM = 2 (v52i standard, more liberal than v3's original 3)
pha.confirm = 2

# === Adjustment Calculation Parameters (v52i standard) ===
# v52i: ADJ_MINLEN = 18
pha.adjust.min-length = 18

# v52i: ADJ_MINPAIR = 2
pha.adjust.min-neighbors = 2

# v52i: ADJ_OUTLIER = 1
pha.adjust.remove-outliers = true

# v52i: ADJ_WINDOW = 0
pha.adjust.window = 0

# v52i: ADJ_FILTER = conf
pha.adjust.filter-method = conf

# v52i: ADJ_EST = med
pha.adjust.est-method = med

# v52i: NS_LOOP = 1
pha.remove-insignificant = true

# === Station History Metadata ===
# v52i: SHF_META = 1
pha.use-history-files = 1

# === Run Control ===
pha.do-run-main = true
pha.do-run-neighbors = true

# === Logger Configuration ===
pha.logger.filename = pha-v52i-equivalent.log
pha.logger.level = INFO
pha.logger.print-to-stdout = true
pha.logger.append-datestamp = false
pha.logger.rollover-datestamp = false
